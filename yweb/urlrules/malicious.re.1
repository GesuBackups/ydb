# These urls are used to insert alien content (specifically, links)
# into pages on good sites
$lowercase_quoted = true
=href
~%3c.*href.*(%2F%2F|//|http)

^^([^/]+://)?[^/]*vk\.com/
^^([^/]+://)?[^/]*facebook\.com/

+/%2F
+%2F/

# href url-encoded surely means garbage
+%68%72%65%66
+h%72%65%66
+hr%65%66
+%68r%65%66
+h%72e%66
+%68%72e%66
+hre%66
+%68re%66
+h%72%65f
+%68%72%65f
+hr%65f
+%68r%65f
+h%72ef
+%68%72ef
+%68ref

#http url-encoded
+%68%74%74%70
+h%74%74%70
+%68t%74%70
+ht%74%70
+%68%74t%70
+h%74t%70
+%68tt%70
+htt%70
+%68%74%74p
+h%74%74p
+%68t%74p
+ht%74p
+%68%74tp
+h%74tp
+%68ttp

#iframe
+ifram%65
+ifra%6de
+ifra%6d%65
+ifr%61me
+ifr%61m%65
+ifr%61%6de
+ifr%61%6d%65
+if%72ame
+if%72am%65
+if%72a%6de
+if%72a%6d%65
+if%72%61me
+if%72%61m%65
+if%72%61%6de
+if%72%61%6d%65
+i%66rame
+i%66ram%65
+i%66ra%6de
+i%66ra%6d%65
+i%66r%61me
+i%66r%61m%65
+i%66r%61%6de
+i%66r%61%6d%65
+i%66%72ame
+i%66%72am%65
+i%66%72a%6de
+i%66%72a%6d%65
+i%66%72%61me
+i%66%72%61m%65
+i%66%72%61%6de
+i%66%72%61%6d%65
+%69frame
+%69fram%65
+%69fra%6de
+%69fra%6d%65
+%69fr%61me
+%69fr%61m%65
+%69fr%61%6de
+%69fr%61%6d%65
+%69f%72ame
+%69f%72am%65
+%69f%72a%6de
+%69f%72a%6d%65
+%69f%72%61me
+%69f%72%61m%65
+%69f%72%61%6de
+%69f%72%61%6d%65
+%69%66rame
+%69%66ram%65
+%69%66ra%6de
+%69%66ra%6d%65
+%69%66r%61me
+%69%66r%61m%65
+%69%66r%61%6de
+%69%66r%61%6d%65
+%69%66%72ame
+%69%66%72am%65
+%69%66%72a%6de
+%69%66%72a%6d%65
+%69%66%72%61me
+%69%66%72%61m%65
+%69%66%72%61%6de
+%69%66%72%61%6d%65

# script
+scrip%74
+scri%70t
+scri%70%74
+scr%69pt
+scr%69p%74
+scr%69%70t
+scr%69%70%74
+sc%72ipt
+sc%72ip%74
+sc%72i%70t
+sc%72i%70%74
+sc%72%69pt
+sc%72%69p%74
+sc%72%69%70t
+sc%72%69%70%74
+s%63ript
+s%63rip%74
+s%63ri%70t
+s%63ri%70%74
+s%63r%69pt
+s%63r%69p%74
+s%63r%69%70t
+s%63r%69%70%74
+s%63%72ipt
+s%63%72ip%74
+s%63%72i%70t
+s%63%72i%70%74
+s%63%72%69pt
+s%63%72%69p%74
+s%63%72%69%70t
+s%63%72%69%70%74
+%73cript
+%73crip%74
+%73cri%70t
+%73cri%70%74
+%73cr%69pt
+%73cr%69p%74
+%73cr%69%70t
+%73cr%69%70%74
+%73c%72ipt
+%73c%72ip%74
+%73c%72i%70t
+%73c%72i%70%74
+%73c%72%69pt
+%73c%72%69p%74
+%73c%72%69%70t
+%73c%72%69%70%74
+%73%63ript
+%73%63rip%74
+%73%63ri%70t
+%73%63ri%70%74
+%73%63r%69pt
+%73%63r%69p%74
+%73%63r%69%70t
+%73%63r%69%70%74
+%73%63%72ipt
+%73%63%72ip%74
+%73%63%72i%70t
+%73%63%72i%70%74
+%73%63%72%69pt
+%73%63%72%69p%74
+%73%63%72%69%70t
+%73%63%72%69%70%74

=script
~[?].*%3c.*script.*src.*http

=iframe
~[?].*%3c.*iframe.*http

+src%3dhttp
