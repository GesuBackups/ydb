role_groups:
  lockbox:
    name: "Lockbox roles"

roles:
  lockbox.admin:
    groups: [lockbox]
    name: "Lockbox admin"
    visibility: public
    description: "Доступ ко всем методам Lockbox"
    includedRoles:
      - lockbox.editor
      - lockbox.payloadViewer
    permissions:
      - lockbox.secrets.listAccessBindings
      - lockbox.secrets.updateAccessBindings

  lockbox.editor:
    groups: [lockbox]
    name: "Lockbox editor"
    visibility: public
    description: "Просмотр и изменение метаданных секрета, изменение payload секрета"
    includedRoles:
      - lockbox.viewer
    permissions:
      - lockbox.secrets.create
      - lockbox.secrets.delete
      - lockbox.secrets.updateMeta
      - lockbox.secrets.updateStatus
      - lockbox.secrets.addVersion
      - lockbox.secrets.removeVersion
      - lockbox.secrets.restoreVersion

  lockbox.viewer:
    groups: [lockbox]
    name: "Lockbox viewer"
    visibility: public
    description: "Просмотр метаданных секрета"
    permissions:
      - iam.folders.get
      - resource-manager.folders.get
      - lockbox.secrets.get
      - lockbox.secrets.listAccessBindings
      - lockbox.quotas.get

  lockbox.payloadViewer:
    groups: [lockbox]
    name: "Lockbox payload viewer"
    visibility: public
    description: "Просмотр payload секрета"
    permissions:
      - lockbox.secrets.getPayload

  lockbox.support:
    groups: [lockbox]
    name: "Lockbox support engineer"
    description: "Role for support engineers"
    visibility: internal
    includedRoles:
      - lockbox.viewer
    permissions:
      - lockbox.quotas.updateLimit

  lockbox.supportAdmin:
    groups: [lockbox]
    name: "Lockbox support admin"
    description: "Privileged operations for support engineers"
    visibility: internal
    includedRoles:
      - lockbox.support
    permissions: []

  lockbox.onCall:
    groups: [lockbox]
    name: "Lockbox on-call engineer"
    visibility: internal
    description: "Role for Lockbox on-call engineers"
    includedRoles:
      - onCall
      - lockbox.viewer
    permissions:
      - lockbox.secrets.listAccessBindings
      - lockbox.quotas.updateLimit
      - lockbox.tool.exec

  lockbox.onCallAdmin:
    groups: [lockbox]
    name: "Lockbox on-call admin"
    visibility: internal
    description: "Role for Lockbox on-call admins"
    includedRoles:
      - lockbox.onCall
    permissions: []
