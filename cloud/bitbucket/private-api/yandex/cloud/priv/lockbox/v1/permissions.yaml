permissions:
  lockbox.secrets.create:
    description: ''
    stage: LOCKBOX_ALPHA
    visibility: public
    allowedWhen:
      cloud:
        status:
          - ACTIVE
    resourceType: resource-manager.folder

  lockbox.secrets.delete:
    description: ''
    stage: LOCKBOX_ALPHA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
          - ACTIVE
          - BLOCKED_BY_BILLING
          - DELETING
    resourceType: lockbox.secret

  lockbox.secrets.forceDelete:
    description: Delete lockbox secret ignoring deletion protection
    stage: LOCKBOX_ALPHA
    visibility: internal
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
          - ACTIVE
          - BLOCKED_BY_BILLING
          - DELETING

  lockbox.secrets.updateMeta:
    description: ''
    stage: LOCKBOX_ALPHA
    visibility: public
    allowedWhen:
      cloud:
        status:
          - ACTIVE
    resourceType: lockbox.secret

  lockbox.secrets.updateStatus:
    description: ''
    stage: LOCKBOX_ALPHA
    visibility: public
    allowedWhen:
      cloud:
        status:
          - ACTIVE
    resourceType: lockbox.secret

  lockbox.secrets.get:
    description: ''
    stage: LOCKBOX_ALPHA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
          - ACTIVE
          - BLOCKED_BY_BILLING
          - DELETING
    resourceType: lockbox.secret

  lockbox.secrets.addVersion:
    description: ''
    stage: LOCKBOX_ALPHA
    visibility: public
    allowedWhen:
      cloud:
        status:
          - ACTIVE
    resourceType: lockbox.secret

  lockbox.secrets.removeVersion:
    description: ''
    stage: LOCKBOX_ALPHA
    visibility: public
    allowedWhen:
      cloud:
        status:
          - ACTIVE
    resourceType: lockbox.secret

  lockbox.secrets.restoreVersion:
    description: ''
    stage: LOCKBOX_ALPHA
    visibility: public
    allowedWhen:
      cloud:
        status:
          - ACTIVE
    resourceType: lockbox.secret

  lockbox.secrets.getPayload:
    description: ''
    stage: LOCKBOX_ALPHA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
          - ACTIVE
          - BLOCKED_BY_BILLING
          - DELETING
    resourceType: lockbox.secret

  lockbox.secrets.listAccessBindings:
    description: ''
    stage: LOCKBOX_ALPHA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
          - ACTIVE
          - BLOCKED_BY_BILLING
          - DELETING
    resourceType: lockbox.secret

  lockbox.secrets.updateAccessBindings:
    description: ''
    stage: LOCKBOX_ALPHA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
      cloud:
        status:
          - ACTIVE
          - BLOCKED_BY_BILLING
    resourceType: lockbox.secret

  lockbox.quotas.get:
    description: Get lockbox quota
    stage: LOCKBOX_ALPHA
    visibility: public
    allowedWhen:
      restrictions:
        - billSuspend
        - fraud
        - deletingContainer
      cloud:
        status:
          - ACTIVE
          - BLOCKED_BY_BILLING
          - DELETING

  lockbox.quotas.updateLimit:
    description: Update lockbox quota limits
    stage: LOCKBOX_ALPHA
    visibility: internal
    allowedWhen:
      restrictions:
        - billSuspend
      cloud:
        status:
          - ACTIVE
          - BLOCKED_BY_BILLING

  lockbox.tool.exec:
    description: Lockbox tool actions
    stage: LOCKBOX_ALPHA
    visibility: internal
    allowedWhen:
      cloud:
        status:
          - BLOCKED
          - BLOCKED_BY_BILLING
          - ACTIVE
          - DELETING