syntax = "proto3";

package yandex.cloud.priv.healthcheck.v1alpha;

import "yandex/cloud/api/operation.proto";
import "yandex/cloud/priv/validation.proto";
import "yandex/cloud/priv/operation/operation.proto";

import "yandex/cloud/priv/healthcheck/v1alpha/health_check_group.proto";
option go_package = "a.yandex-team.ru/cloud/bitbucket/private-api/yandex/cloud/priv/healthcheck/v1alpha;healthcheck";
option java_outer_classname = "PHCGS";

service HealthCheckGroupService {
  rpc Get (GetHealthCheckGroupRequest) returns (HealthCheckGroup) {}

  rpc Upsert (UpsertHealthCheckGroupRequest) returns (operation.Operation) {
    option (yandex.cloud.api.operation) = {
      response: "HealthCheckGroup"
    };
  }
  rpc Delete (DeleteHealthCheckGroupRequest) returns (operation.Operation) {
    option (yandex.cloud.api.operation) = {
      response: "google.protobuf.Empty"
    };
  }

  rpc GetHealth (HealthRequest) returns (HealthResponse) {}
  rpc StreamHealth (HealthRequest) returns (stream HealthCheckResult) {}
}

message GetHealthCheckGroupRequest {
  string health_check_group_id = 1 [(length) = "<=50"];
}

message UpsertHealthCheckGroupRequest {
  string health_check_group_id = 1 [(length) = "<=50"];
  repeated HealthCheckGroup.Target targets = 2; // Note that empty list is allowed.
  repeated HealthCheck health_checks = 3 [(size) = ">=1"];

  string folder_id = 4;

  HealthCheckGroup.Owner owner = 5;
}

message DeleteHealthCheckGroupRequest {
  string health_check_group_id = 1 [(length) = "<=50"];
}

message HealthRequest {
  string health_check_group_id = 1 [(length) = "<=50"];
}

message HealthResponse {
  repeated HealthCheckResult health_check_result = 1;
}
