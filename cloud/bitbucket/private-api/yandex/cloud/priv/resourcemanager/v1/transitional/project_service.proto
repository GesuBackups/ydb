syntax = "proto3";

package yandex.cloud.priv.resourcemanager.v1.transitional;

import "google/api/annotations.proto";
import "google/protobuf/timestamp.proto";

option go_package = "a.yandex-team.ru/cloud/bitbucket/private-api/yandex/cloud/priv/resourcemanager/v1/transitional;iam";
option java_outer_classname = "PTPS";

service ProjectService {
  rpc List (ListProjectsRequest) returns (ListProjectsResponse) {
    option (google.api.http) = { get: "/yrm/v1/allProjects" };
  }

  rpc GetStatus (GetProjectStatusRequest) returns (GetProjectStatusResponse) {
    option (google.api.http) = { get: "/yrm/v1/org/{organization_id}/project/{project_id}/status" };
  }

  rpc SetStatus (SetProjectStatusRequest) returns (SetProjectStatusResponse) {
    option (google.api.http) = { post: "/yrm/v1/org/{organization_id}/project/{project_id}/status" body: "*" };
  }

  rpc Delete (DeleteProjectRequest) returns (OldStyleOperation) {
    option (google.api.http) = { delete: "/yrm/v1/projects/{project_id}" };
  }
}

message ListProjectsRequest {
  string id = 1;
  string name = 2;
  string organization_id = 3;
}

message ListProjectsResponse {
  repeated Project result = 1;

  message Project {
    string id = 1;
    string description = 2;
    string organization_id = 3;
    string name = 4;
    string status = 5;
  }
}

message GetProjectStatusRequest {
  string project_id = 1;
  string organization_id = 2;
}

message GetProjectStatusResponse {
  string status = 1;
}

message SetProjectStatusRequest {
  string project_id = 1;
  string organization_id = 2;
  string status = 3;
}

message SetProjectStatusResponse {
  string result = 1;
}

message DeleteProjectRequest {
  string project_id = 1;
}

message OldStyleOperation {
  string id = 1;
  string created_by = 2;
  string operation_type = 3;
  string target_id = 4;
  google.protobuf.Timestamp started_at = 5;
  google.protobuf.Timestamp modified_at = 6;
  string status = 7;
  int64 progress = 8;
  string status_message = 9;
  repeated Error errors = 10;

  message Error {
    string type = 1;
    string message = 2;
  }
}
