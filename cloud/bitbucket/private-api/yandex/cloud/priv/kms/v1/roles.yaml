role_groups:
  kms:
    name: KMS roles

roles:
  kms.viewer.pseudo:
    groups: [kms]
    name: KMS Viewer
    description: ''
    visibility: public
    pseudorole: true
    permissions:
      - kms.keys.listAccessBindings
      - kms.keys.{get,list}
      - kms.quotas.get
      - kms.keystores.get

  kms.viewer:
    groups: [ kms ]
    name: KMS Viewer
    description: Чтение в KMS
    visibility: public
    includedRoles:
      - kms.viewer.pseudo

  kms.editor.pseudo:
    groups: [kms]
    name: KMS Editor
    description: ''
    visibility: public
    pseudorole: true
    includedRoles:
      - kms.viewer
    permissions:
      - kms.keys.create
      - kms.keys.strongEncryption
      - kms.keys.decrypt
      - kms.keys.encrypt
      - kms.keys.rotate
      - kms.keys.updateMeta
      - kms.keys.updateRotation
      - kms.keystores.create
      - kms.keystores.rotate
      - kms.keystores.update
      - kms.keystores.export
      - kms.randomGenerators.generate

  kms.editor:
    groups: [ kms ]
    name: KMS Editor
    description: Чтение и запись в KMS
    visibility: public
    includedRoles:
      - kms.editor.pseudo

  kms.admin:
    groups: [kms]
    name: Администратор KMS
    visibility: public
    description: доступ ко всем методам KMS
    includedRoles:
      - kms.editor
    permissions:
      - kms.keys.cancelDelete
      - kms.keys.delete
      - kms.keys.setPrimaryVersion
      - kms.keys.updateStatus
      - kms.keys.listAccessBindings
      - kms.keys.updateAccessBindings
      - kms.keystores.delete
      - iam.folders.get
      - resource-manager.folders.get

  kms.keys.encrypterDecrypter:
    groups: [kms]
    name: ''
    visibility: public
    description: Роль для доступа к криптографическим операциям на ключе
    permissions:
      - kms.keys.encrypt
      - kms.keys.decrypt
      - kms.keys.get
      - kms.randomGenerators.generate

  kms.support:
    groups: [kms, support]
    name: Support KMS
    description: Role for support engineers
    visibility: internal
    includedRoles:
      - kms.viewer
    permissions:
      - kms.quotas.updateLimit

  kms.supportAdmin:
    groups: [kms, support]
    name: Support KMS Admin
    description: Privileged operations for support engineers
    visibility: internal
    includedRoles:
      - kms.support
    permissions:
      - kms.keys.cancelDelete

  kms.onCall:
    groups: [ kms, staff ]
    name: OnCall KMS
    description: Role for on-call engineers
    visibility: internal
    includedRoles:
      - onCall
      - kms.viewer
    permissions:
      - kms.keys.cancelDelete
      - kms.keys.listAccessBindings
      - kms.quotas.updateLimit

  internal.kms.sync:
    groups: [ kms ]
    name: Sync KMS
    visibility: internal
    description: Role for the sync service
    permissions:
      - kms.keys.get
      - kms.keys.listAccessBindings
      - kms.keys.updateAccessBindings
