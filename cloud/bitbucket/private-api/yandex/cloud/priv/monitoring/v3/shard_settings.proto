syntax = "proto3";

package yandex.cloud.priv.monitoring.v3;

import "google/protobuf/duration.proto";

option go_package = "a.yandex-team.ru/cloud/bitbucket/private-api/yandex/cloud/priv/monitoring/v3;monitoring";

message ShardSettings {
  message AggregationSettings {
    bool enabled = 1;

    repeated AggregationRule rules = 2;

    // Checks that all metrics will be written in mem-only storage.
    bool mem_only = 3;
  }

  message AggregationRule {
    // List of conditions.
    repeated string conditions = 1;

    // List of targets.
    repeated string targets = 2;
  }

  enum RetentionPolicy {
    RETENTION_POLICY_UNSPECIFIED = 0;

    FIVE_MIN_AFTER_WEEK = 1;

    ONE_MIN_AFTER_MONTH_FIVE_MIN_AFTER_THREE_MONTHS = 2;

    ONE_MIN_AFTER_MONTH_FIVE_MIN_AFTER_TWO_MONTHS = 3;

    FIVE_MIN_AFTER_TWO_MONTHS = 4;

    KEEP_FOREVER = 5;
  }

  enum HostLabelPolicy {
    HOST_LABEL_POLICY_UNSPECIFIED = 0;

    SHORT_HOSTNAME = 1;

    FULL_HOSTNAME = 2;

    NO_HOSTNAME = 3;
  }

  message PullSettings {
    int64 port = 1;

    string path = 2;

    // Adds ts argument to pull endpoint (for pull only).
    bool add_timestamp_args = 3;

    // Pull interval.
    google.protobuf.Duration pull_interval = 4;

    // ID of TVM destination client.
    string tvm_destination_id = 5;

    HostLabelPolicy host_label_policy = 6;
  }

  message PushSettings {

  }

  oneof type {
    PullSettings pull_settings = 1;

    PushSettings push_settings = 2;
  }

  // Grid.
  google.protobuf.Duration grid = 3;

  // Metrics TTL.
  int64 metrics_ttl_days = 4;

  // Retention policy.
  RetentionPolicy retention_policy = 5;

  // List of the aggregation rules.
  AggregationSettings aggregation_settings = 6;
}
