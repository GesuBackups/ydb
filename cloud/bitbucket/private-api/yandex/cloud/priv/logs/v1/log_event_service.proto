syntax = "proto3";

package yandex.cloud.priv.logs.v1;

import "google/protobuf/timestamp.proto";
import "yandex/cloud/priv/validation.proto";
import "yandex/cloud/priv/logs/v1/log_event.proto";


option go_package = "a.yandex-team.ru/cloud/bitbucket/private-api/yandex/cloud/priv/logs/v1;logs";
option java_outer_classname = "PLES";

service LogEventService {
  rpc Read (ReadLogEventsRequest) returns (ReadLogEventsResponse);
  rpc Write (WriteLogEventsRequest) returns (WriteLogEventsResponse);
}

message ReadLogEventsRequest {
  string log_group_id = 1 [(required) = true];
  string stream_name = 2 [(required) = true];

  int64 page_size = 5;
  oneof selector {
    string page_token = 6;
    Criteria criteria = 7;
  }
}

message ReadLogEventsResponse {
  repeated LogEvent log_events= 1;
  string next_page_token = 2;
  string previous_page_token = 3;
}

message WriteLogEventsRequest {
  string log_group_id = 1 [(required) = true];
  string stream_name = 2 [(required) = true];
  repeated IncomingLogEvent events = 3 [(size) = "<=100"];
}

message WriteLogEventsResponse {
}

message IncomingLogEvent {
  google.protobuf.Timestamp created_at = 1 [(required) = true]; // user defined timestamp
  string message = 2 [(length) = "<=262144"];
}

message Criteria {
  google.protobuf.Timestamp since = 1;
  google.protobuf.Timestamp until = 2;
}
