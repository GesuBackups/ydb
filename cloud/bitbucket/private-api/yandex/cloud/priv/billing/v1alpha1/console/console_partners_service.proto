syntax = "proto3";

package yandex.cloud.priv.billing.v1alpha1;

import "google/api/annotations.proto";
import "yandex/cloud/priv/validation.proto";
import "yandex/cloud/priv/billing/v1alpha1/billing_account.proto";
import "yandex/cloud/priv/billing/v1alpha1/currency.proto";
import "google/protobuf/timestamp.proto";

option go_package = "a.yandex-team.ru/cloud/bitbucket/private-api/yandex/cloud/priv/billing/v1alpha1/console;billing";

service ConsolePartnerAccountsService {

  rpc GetPartnerDashboard (PartnerDashboardFilterRequest) returns (PartnerDashboardResponse) {
    option (google.api.http) = {get: "/billing/v1alpha1/console/partners"};
  }

}

message PartnerDashboardFilterRequest {
  bool is_var = 1;
  bool is_referrer = 2;
  string page_token = 3;
  int64 page_size = 4 [(value) = "0-1000"];
}

message PartnerDashboardResponse {
  repeated string vars = 1;
  repeated string referrers = 2;
  map<string, PartnerAccount> partners = 3;
  string next_page_token = 4;
}

message ReferrerInfo {
  string name = 1;
  string contract_number = 2;
  string contract_date = 3;
  string account = 4;
  BillingAccount.ReferrerStatus status = 5;


}
message PartnerAccount {//Almost the same as BillingAccount
  string id = 1;
  string name = 2;

  BillingAccount.Type type = 3;
  BillingAccount.PaymentType payment_type = 4;
  BillingAccount.UsageStatus usage_status = 5;

  // Decimal
  string billing_threshold = 6;
  // Decimal
  string balance = 7;
  string master_account_id = 8;
  BillingAccount.PersonType person_type = 9;

  Currency currency = 10;
  string display_status = 11;
  string owner_id = 12;

  BillingAccount.State state = 13;

  google.protobuf.Timestamp created_at = 14;
  google.protobuf.Timestamp updated_at = 15;

  bool is_subaccount = 16;
  bool is_var = 17;

  string payment_method_id = 18;
  string person_id = 19;
  string balance_contract_id = 20;
  string balance_client_id = 21;
  // skipping unused fields from BA
  map<string, bool> feature_flags = 27;
  bool is_referrer = 28;
  ReferrerInfo referrer_info = 29;
}
