syntax = "proto3";

package yandex.cloud.priv.billing.v1alpha1;

import "google/api/annotations.proto";
import "yandex/cloud/priv/billing/v1alpha1/light_metric.proto";
import "yandex/cloud/priv/validation.proto";

option go_package = "a.yandex-team.ru/cloud/bitbucket/private-api/yandex/cloud/priv/billing/v1alpha1/private;billing";

service PrivateUnparsedMetricsService {
    rpc GetUnparsedMetrics (ListUnparsedMetricsRequest) returns (UnparsedMetricListResponse) {
        option (google.api.http) = { get: "/billing/v1alpha1/private/unparsedMetrics"};
    }
}

message ListUnparsedMetricsRequest {
    string source_name = 1 [(required) = true];
    int64 start_time = 2 [(value) = ">=0"];
    int64 end_time = 3;
}


message UnparsedMetricResponse {
  string source_name = 1;
  int64 timestamp = 2;
  string reason = 3;
  LightMetric metric = 4;
  string hostname = 5;
}

message UnparsedMetricListResponse {
  repeated UnparsedMetricResponse unparsed_metrics = 1 [(size) = "<=1000"]; // No paginating. Up to 1000 metrics per response.
  bool is_truncated = 2;
  int64 total_count = 3;
}
