syntax = "proto3";

package yandex.cloud.priv.billing.v1alpha1;

import "google/api/annotations.proto";

option go_package = "a.yandex-team.ru/cloud/bitbucket/private-api/yandex/cloud/priv/billing/v1alpha1/console;billing";

service ConsoleReferrerRewardReportService {
    rpc ReferrerReport (ReferrerRewardReportRequest) returns (ReferrerRewardReportResponse) {
        option (google.api.http) = { post: "/billing/v1alpha1/console/referrers/{referrer_id}/rewardReport" body: "*"};
    }
}

message ReferrerRewardReportRequest {
    string referrer_id = 1;
    string start_reward_month = 2; // YYYY-MM, optional
    string end_reward_month = 3; // YYYY-MM, optional
    repeated string referral_code_ids = 4;  // optional
}

message ReferrerRewardReportResponse {
    message ReferralMeta {
        string name = 1;
        string code_id = 2;
    }
    message DiagramData {
        string referral_id = 1;
        // name from meta
        string reward_month = 2; // YYYY-MM
        double month_reward = 3; // Decimal
    }
    message TableData {
        string referral_id = 1;
        // name and code_id from meta
        string total_reward = 2;  // Decimal
    }

    map<string, ReferralMeta> referrals_meta = 1; // referral_id: {name some_name:, code_id: some_code}
    DiagramData diagram_data = 2;
    TableData table_data = 3;
}
