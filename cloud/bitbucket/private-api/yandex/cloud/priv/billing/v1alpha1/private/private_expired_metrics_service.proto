syntax = "proto3";

package yandex.cloud.priv.billing.v1alpha1;

import "google/api/annotations.proto";
import "yandex/cloud/priv/billing/v1alpha1/light_metric.proto";
import "yandex/cloud/priv/validation.proto";

option go_package = "a.yandex-team.ru/cloud/bitbucket/private-api/yandex/cloud/priv/billing/v1alpha1/private;billing";

service PrivateExpiredMetricsService {
    rpc GetExpiredMetrics (ListExpiredMetricsRequest) returns (ExpiredMetricListResponse) {
        option (google.api.http) = { get: "/billing/v1alpha1/private/expiredMetrics"};
    }
}

message ListExpiredMetricsRequest {
    string source_name = 1 [(required) = true];
    int64 start_time = 2 [(value) = ">=0"];
    int64 end_time = 3;
    string schema = 4;
}


message ExpiredMetricResponse {
  string source_name = 1;
  int64 uploaded_at = 2;
  string schema = 3;
  string metric_id = 4;
  string source_id = 5;
  int64 end_time = 6;
  int64 message_write_ts = 7;
  LightMetric metric = 8;
}

message ExpiredMetricListResponse {
  repeated ExpiredMetricResponse expired_metrics = 1 [(size) = "<=1000"]; // No paginating. Up to 1000 metrics per response.
  bool is_truncated = 2;
  int64 total_count = 3;
}
