syntax = "proto3";

package yandex.cloud.priv.billing.v1alpha1;

import "google/api/annotations.proto";

import "yandex/cloud/priv/billing/v1alpha1/publisher_account.proto";
import "yandex/cloud/priv/billing/v1alpha1/person.proto";
import "yandex/cloud/priv/billing/v1alpha1/currency.proto";
import "yandex/cloud/priv/billing/v1alpha1/revenue_meta.proto";
import "yandex/cloud/priv/billing/v1alpha1/revenue_report.proto";
import "yandex/cloud/priv/operation/operation.proto";
import "yandex/cloud/api/operation.proto";
import "yandex/cloud/api/tools/options.proto";

option go_package = "a.yandex-team.ru/cloud/bitbucket/private-api/yandex/cloud/priv/billing/v1alpha1/private;billing";

service PrivatePublisherAccountsService {
  rpc GetPublisherAccount (PublisherAccountInfoPrivateRequest) returns (PublisherAccount) {
    option (google.api.http) = { get: "/billing/v1alpha1/private/publisherAccounts/{publisher_account_id}" };
  }
  rpc CreatePublisherAccount (PublisherAccountCreatePrivateRequest) returns (operation.Operation){
    option (google.api.http) = { post: "/billing/v1alpha1/private/publisherAccounts" body: "*"};
    option (yandex.cloud.api.operation) = {
      metadata: "PublisherAccountIDPrivateMetadata"
      response: "PublisherAccount"
    };
  }
  rpc UpdatePublisherAccount (PublisherAccountUpdatePrivateRequest) returns (operation.Operation) {
    option (google.api.http) = { patch: "/billing/v1alpha1/private/publisherAccounts/{publisher_account_id}" body: "*"};
    option (yandex.cloud.api.operation) = {
      metadata: "PublisherAccountIDPrivateMetadata"
      response: "PublisherAccount"
    };
  }
  rpc GetPersons (PublisherAccountIDPrivateRequest) returns (PersonsPrivateList) {
    option (google.api.http) = { get: "/billing/v1alpha1/private/publisherAccounts/{publisher_account_id}/persons" };
  }
  rpc GetRevenueMeta (PublisherAccountIDPrivateRequest) returns (RevenueMeta) {
    option (google.api.http) = { get: "/billing/v1alpha1/private/publisherAccounts/{publisher_account_id}/revenueMeta" };
  }
  rpc GetRevenueReport (RevenueReportPrivateRequest) returns (RevenueReportPrivateResponse) {
    option (google.api.http) = { post: "/billing/v1alpha1/private/publisherAccounts/{publisher_account_id}/skuRevenueReport" body: "*"};
    option (yandex.cloud.api.tools.method).lint_skip.http_verb = true;
  }
}

message PublisherAccountInfoPrivateRequest {
  string publisher_account_id = 1;
  enum View {
    VIEW_UNSPECIFIED = 0;
    SHORT = 1;
    FULL = 2;
  }
  View view = 2;
}
message PublisherAccountCreatePrivateRequest {
  string publisher_account_id = 1;
  string passport_uid = 2;
  string marketplace_publisher_id = 3;
  string name = 4;
  Currency currency = 5;
  enum PaymentCycleType {
      PAYMENT_CYCLE_TYPE_UNSPECIFIED = 0;
      MONTHLY = 1;
      QUARTER = 2;
    }
  PaymentCycleType payment_cycle_type = 6;
  string person_id = 7;
  message PersonData {
    enum Type {
      TYPE_UNSPECIFIED = 0;
      COMPANY = 1;
      INDIVIDUAL = 2;
    }
    Type type = 1;
    Company company = 2;
    Individual individual = 3;
  }
  PersonData person_data = 8;
}

message PublisherAccountIDPrivateMetadata {
  string publisher_account_id = 1;
}
message PublisherAccountIDPrivateRequest {
  string publisher_account_id = 1;
}
message PublisherAccountUpdatePrivateRequest {
  string publisher_account_id = 1;
  string passport_uid = 2;
  string name = 3;
  string contract_id = 4;
  enum PaymentCycleType {
      PAYMENT_CYCLE_TYPE_UNSPECIFIED = 0;
      MONTHLY = 1;
      QUARTER = 2;
    }
  PaymentCycleType payment_cycle_type = 5;
}

message PersonsPrivateList {
  repeated Person persons = 1;
  string passport_uid = 2;
}
message RevenueReportPrivateRequest {
  string publisher_account_id = 1;
  string start_date = 2;
  string end_date = 3;
  repeated string sku_ids = 4;
}

message RevenueReportPrivateResponse {
  RevenueReport revenue_report = 1;
}
