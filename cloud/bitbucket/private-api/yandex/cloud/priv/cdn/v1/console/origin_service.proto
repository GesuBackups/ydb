syntax = "proto3";

package yandex.cloud.priv.cdn.v1.console;

import "google/protobuf/empty.proto";
import "google/protobuf/wrappers.proto";
import "yandex/cloud/priv/cdn/v1/console/origins_group.proto";
import "yandex/cloud/priv/validation.proto";

option go_package = "a.yandex-team.ru/cloud/bitbucket/private-api/yandex/cloud/priv/cdn/v1/console;cdn_console";

//
// Origin management service.
// Origin is not a standalone entity. It can live only inside origin group
//
service OriginService {
  // Get origin in origin group
  rpc Get(GetOriginRequest) returns (Origin);

  // List origins of origin group
  rpc List(ListOriginsRequest) returns (ListOriginsResponse);

  // Create origin inside origin group
  rpc Create(CreateOriginRequest) returns (Origin);

  // Update origin from origin group
  rpc Update(UpdateOriginRequest) returns (Origin);

  // Delete origin from origin group
  rpc Delete(DeleteOriginRequest) returns (google.protobuf.Empty);
}

message GetOriginRequest {
  string folder_id = 1 [(required) = true, (length) = "<=50"];
  int64 origin_group_id = 2 [(value) = ">0"];
  int64 origin_id = 3 [(value) = ">0"];
}

message ListOriginsRequest {
  string folder_id = 1 [(required) = true, (length) = "<=50"];
  int64 origin_group_id = 2 [(value) = ">0"];
}

message ListOriginsResponse {
  repeated Origin origins = 1;
}

message CreateOriginRequest {
  string folder_id = 1 [(required) = true, (length) = "<=50"];
  int64 origin_group_id = 2 [(value) = ">0"];

  string source = 3 [(required) = true, (length) = "<=50"];

  // default value true
  google.protobuf.BoolValue enabled = 4;

  // default value: false
  google.protobuf.BoolValue backup = 5;

  // default value: COMMON
  OriginType type = 6;

  OriginMeta meta = 7;
}

message UpdateOriginRequest {
  string folder_id = 1 [(required) = true, (length) = "<=50"];
  int64 origin_group_id = 2 [(value) = ">0"];
  int64 origin_id = 3 [(value) = ">0"];

  // PUT behaviour, parameter below will be fully rewritten

  // Required
  string source = 4;
  // Required
  bool enabled = 5;
  // Required
  bool backup = 6;
  // Required
  OriginType type = 7;
  // Required
  OriginMeta meta = 8;
}

message DeleteOriginRequest {
  string folder_id = 1 [(required) = true, (length) = "<=50"];
  int64 origin_group_id = 2 [(value) = ">0"];
  int64 origin_id = 3 [(value) = ">0"];
}
