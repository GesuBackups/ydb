syntax = "proto3";

package yandex.cloud.priv.cdn.v1;

import "google/protobuf/wrappers.proto";

import "yandex/cloud/api/operation.proto";
import "yandex/cloud/priv/cdn/v1/origin.proto";
import "yandex/cloud/priv/cdn/v1/origin_group.proto";
import "yandex/cloud/priv/operation/operation.proto";
import "yandex/cloud/priv/validation.proto";

option go_package = "a.yandex-team.ru/cloud/bitbucket/private-api/yandex/cloud/priv/cdn/v1;cdn";
option java_outer_classname = "PORGGS";

//
// Origin Groups management service.
//
service OriginGroupService {
    // Get origin group with specified origin group id.
    rpc Get(GetOriginGroupRequest) returns (OriginGroup);

    // List clients origin groups.
    rpc List(ListOriginGroupsRequest) returns (ListOriginGroupsResponse);

    // Create clients origin group.
    rpc Create(CreateOriginGroupRequest) returns (operation.Operation) {
        option (yandex.cloud.api.operation) = {
          metadata: "CreateOriginGroupMetadata"
          response: "OriginGroup"
        };
    }

    // Update clients origin group.
    rpc Update(UpdateOriginGroupRequest) returns (operation.Operation) {
        option (yandex.cloud.api.operation) = {
          metadata: "UpdateOriginGroupMetadata"
          response: "OriginGroup"
        };
    }

    // Delete origin group with specified origin group id.
    rpc Delete(DeleteOriginGroupRequest) returns (operation.Operation) {
        option (yandex.cloud.api.operation) = {
          metadata: "DeleteOriginGroupMetadata"
          response: "google.protobuf.Empty"
        };
    }
}

message GetOriginGroupRequest {
    // Origin group owner's Folder ID.
    string folder_id = 1 [(required) = true, (length) = "<=50"];
    // ID of origin group to request for.
    int64 origin_group_id = 2 [(value) = ">0"];
}

message ListOriginGroupsRequest {
    // Origin group owner's Folder ID.
    string folder_id = 1 [(required) = true, (length) = "<=50"];
    // The maximum number of results per page to return. If the number of available
    // results is larger than [page_size],
    // the service returns a [ListOriginGroupsResponse.next_page_token]
    // that can be used to get the next page of results in subsequent list requests.
    int64 page_size = 2 [(value) = "<=1000"];
    // Page token. To get the next page of results,
    // set [page_token] to the [ListOriginGroupsResponse.next_page_token]
    // returned by a previous list request.
    string page_token = 3 [(length) = "<=100"];
}

message ListOriginGroupsResponse {
    // List of all Origin Groups associated with folder.
    repeated OriginGroup origin_groups = 1;
    // [next_page_token] token allows you to get the next page of results for list requests.
    // If the number of results is larger than [ListOriginGroupsRequest.page_size], use
    // the [next_page_token] as the value for the [ListOriginGroupsRequest.page_token] query parameter
    // in the next list request. Each subsequent list request will have its own
    // [next_page_token] to continue paging through the results.
    string next_page_token = 2;
}

message CreateOriginGroupRequest {
    // Origin group owner's Folder ID.
    string folder_id = 1 [(required) = true, (length) = "<=50"];
    // Origin Group Name.
    string name = 2;
    // [use_next] This option have two possible conditions:
    //  true - The option is active. In case the origin responds with 4XX or 5XX codes,
    //         use the next origin from the list.
    //  false - The option is disabled.
    //
    //  default value is true
    google.protobuf.BoolValue use_next = 3;
    // List of origins: IP addresses or Domain names of your origins and the port
    // (if custom).
    repeated OriginParams origins = 4;
}

message CreateOriginGroupMetadata {
    // ID of created Origin Group.
    int64 origin_group_id = 1 [(value) = ">0"];
}

message UpdateOriginGroupRequest {
    // Origin Group owner's Folder ID.
    string folder_id = 1 [(required) = true, (length) = "<=50"];
    // Origin Group ID.
    int64 origin_group_id = 2 [(value) = ">0"];
    // Origin Group name.
    google.protobuf.StringValue group_name = 3;
    // This option have two possible values:
    //
    //   True - The option is active. In case the origin responds with 4XX or 5XX
    //          codes, use the next origin from the list.
    //   False - The option is disabled.
    google.protobuf.BoolValue use_next = 4;
    // List of origins: IP addresses or Domain names of your origins and the port
    // (if custom).
    repeated OriginParams origins = 5;
}

message UpdateOriginGroupMetadata {
    // Origin Group ID.
    int64 origin_group_id = 1 [(value) = ">0"];
}

message DeleteOriginGroupRequest {
    // Origin Group owner's Folder ID.
    string folder_id = 1 [(required) = true, (length) = "<=50"];
    // Origin Group ID.
    int64 origin_group_id = 2 [(value) = ">0"];
}

message DeleteOriginGroupMetadata {
    // Origin Group ID.
    int64 origin_group_id = 1 [(value) = ">0"];
}
