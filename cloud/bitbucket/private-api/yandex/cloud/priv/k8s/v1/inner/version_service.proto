syntax = "proto3";

package yandex.cloud.priv.k8s.v1.inner;

import "google/protobuf/empty.proto";
import "yandex/cloud/priv/k8s/v1/inner/common.proto";

option go_package = "a.yandex-team.ru/cloud/bitbucket/private-api/yandex/cloud/priv/k8s/v1/inner;k8s";
option java_outer_classname = "PMKIVS";

service VersionService {
  rpc List (ListVersionsRequest) returns (ListVersionsResponse);
  rpc Delete(DeleteVersionRequest) returns (google.protobuf.Empty);
  rpc Upsert(UpsertVersionRequest) returns (google.protobuf.Empty);
  rpc Deprecate(DeprecateVersionRequest) returns (google.protobuf.Empty);
  rpc SetDefault(SetDefaultVersionRequest) returns (google.protobuf.Empty);
  rpc Channels (ChannelsRequest) returns (ChannelsResponse);
  rpc GetChannel(GetChannelRequest) returns (GetChannelResponse);
  rpc GetLatest(google.protobuf.Empty) returns (GetLatestResponse);
}

message ListVersionsRequest {
}

message ListVersionsResponse {
  repeated LatestVersion latest_versions = 1;
}

message LatestVersion {
  string channel = 1;
  string major_version = 2;
  int64 revision = 3;
}

message DeleteVersionRequest {
  string channel = 1;
  string major_version = 2;
}

message UpsertVersionRequest {
  string channel = 1;
  string major_version = 2;
  int64 revision = 3;
}

message DeprecateVersionRequest {
  string channel = 1;
  string major_version = 2;
}

message SetDefaultVersionRequest {
  string channel = 1;
  string major_version = 2;
}

message ChannelsRequest {
}

message ReleaseChannelVersions  {
  string channel = 1;
  repeated Version versions = 2;
  string deprecated_version = 3;
  string default_version = 4;
}

message ChannelsResponse {
  repeated ReleaseChannelVersions channels = 1;
}

message GetChannelRequest {
  PublicReleaseChannel channel = 1;
}

message GetChannelResponse {
  PublicReleaseChannel channel = 1;
  repeated Version versions = 2;
  string deprecated_version = 3;
  string default_version = 4;
}

message GetLatestResponse {
  repeated Version versions = 2;
}
