syntax = "proto3";

package yandex.cloud.priv.dns.v1.inner;

import "google/protobuf/timestamp.proto";
import "yandex/cloud/priv/dns/v1/dns_zone.proto";

option go_package = "a.yandex-team.ru/cloud/bitbucket/private-api/yandex/cloud/priv/dns/v1/inner;dns";
option java_outer_classname = "PRS";

service ReplicationService {
  rpc GetUpdate (GetUpdateRequest) returns (GetUpdateResponse);
}

message GetUpdateRequest {
  string page_token = 1;
  repeated string clusters = 2;
}

message GetUpdateResponse {
  repeated DnsZone changed_dns_zones = 1;
  repeated DnsZone deleted_dns_zones = 2;
  repeated DnsView changed_dns_views = 3;
  repeated DnsView deleted_dns_views = 4;
  repeated DnsViewZone changed_dns_view_zones = 5;
  repeated DnsViewZone deleted_dns_view_zones = 6;
  repeated RecordSet changed_record_sets = 7;
  repeated RecordSet deleted_record_sets = 8;
  string page_token = 10;
  bool partial = 11;
  int64 checksum = 12; // Only valid when !partial
  google.protobuf.Timestamp first_change = 20;
  google.protobuf.Timestamp last_change = 21;

  message DnsZone {
    string dns_zone_id = 1;

    int64 priority = 2;
    string zone = 10;
    int64 rps_limit = 11;
    ForwardingConfig forwarding_config = 12;

    int64 version = 20;
  }

  message RecordSet {
    string dns_zone_id = 1;
    string name = 2;
    RecordType type = 3;

    int64 ttl = 10;
    repeated bytes data = 11;

    int64 version = 20;
  }

  message DnsView {
    string dns_view_id = 1;

    string tag = 10;
    int64 rps_limit = 11;

    int64 version = 20;
  }

  message DnsViewZone {
    string dns_view_id = 1;
    string dns_zone_id = 2;

    int64 version = 20;
  }

  enum RecordType {
    RECORD_TYPE_UNSPECIFIED = 0;
    A = 1;
    NS = 2;
    MD = 3;
    MF = 4;
    CNAME = 5;
    SOA = 6;
    MB = 7;
    MG = 8;
    MR = 9;
    NULL = 10;
    PTR = 12;
    HINFO = 13;
    MINFO = 14;
    MX = 15;
    TXT = 16;
    RP = 17;
    AFSDB = 18;
    X25 = 19;
    ISDN = 20;
    RT = 21;
    NSAPPTR = 23;
    SIG = 24;
    KEY = 25;
    PX = 26;
    GPOS = 27;
    AAAA = 28;
    LOC = 29;
    NXT = 30;
    EID = 31;
    NIMLOC = 32;
    SRV = 33;
    ATMA = 34;
    NAPTR = 35;
    KX = 36;
    CERT = 37;
    DNAME = 39;
    OPT = 41;
    APL = 42;
    DS = 43;
    SSHFP = 44;
    RRSIG = 46;
    NSEC = 47;
    DNSKEY = 48;
    DHCID = 49;
    NSEC3 = 50;
    NSEC3PARAM = 51;
    TLSA = 52;
    SMIMEA = 53;
    HIP = 55;
    NINFO = 56;
    RKEY = 57;
    TALINK = 58;
    CDS = 59;
    CDNSKEY = 60;
    OPENPGPKEY = 61;
    CSYNC = 62;
    SPF = 99;
    UINFO = 100;
    UID = 101;
    GID = 102;
    UNSPEC = 103;
    NID = 104;
    L32 = 105;
    L64 = 106;
    LP = 107;
    EUI48 = 108;
    EUI64 = 109;
    URI = 256;
    CAA = 257;
    AVC = 258;

    TKEY = 249;
    TSIG = 250;

    IXFR = 251;
    AXFR = 252;
    MAILB = 253;
    MAILA = 254;
    ANY = 255;
  }
}
