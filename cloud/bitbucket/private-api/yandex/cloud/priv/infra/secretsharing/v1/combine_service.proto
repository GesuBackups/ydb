syntax = "proto3";

package yandex.cloud.priv.infra.secretsharing.v1;

option go_package = "a.yandex-team.ru/cloud/bitbucket/private-api/yandex/cloud/priv/infra/secretsharing/v1;secretsharing";
option java_outer_classname = "PSSCS";

import "yandex/cloud/priv/infra/secretsharing/v1/process.proto";
import "yandex/cloud/priv/sensitive.proto";

service CombineService {
    rpc GetPublicKey(GetPublicKeyRequest) returns (GetPublicKeyResponse) {}
    rpc PushSecretPart(PushSecretPartRequest) returns (PushSecretPartResponse) {}
    rpc GetSecret(GetSecretRequest) returns (GetSecretResponse) {}
}

message GetPublicKeyRequest {}

message GetPublicKeyResponse {
    string public_key = 1;
}

message PushSecretPartRequest {
    string user = 1;
    string encrypted_secret_part = 2 [(sensitive) = true];
}

message PushSecretPartResponse {
    string part_id = 1;
}

message GetSecretRequest {
    string part_id = 1;
}

message GetSecretResponse {
    string part_id = 1;
    ProcessStatus current_status = 2;
    Result result = 3;
}
