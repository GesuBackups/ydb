syntax = "proto3";

package yandex.cloud.priv.mdb.v1.console;

import "yandex/cloud/priv/mdb/v1/console/cluster_type.proto";

option go_package = "a.yandex-team.ru/cloud/bitbucket/private-api/yandex/cloud/priv/mdb/v1/console;mdb_console";

service ClusterService {
    rpc GetUsedResources (GetUsedResourcesRequest) returns (GetUsedResourcesResponse);
    rpc GetFolderStats (GetFolderStatsRequest) returns (FolderStats);
}

message GetUsedResourcesRequest {
    repeated string cloud_ids = 1;
}

message GetUsedResourcesResponse {
    enum Type {
      TYPE_UNSPECIFIED = 0;
      POSTGRESQL = 1;
      CLICKHOUSE = 2;
      MONGODB = 3;
      REDIS = 4;
      MYSQL = 5;
      KAFKA = 6;
      ELASTICSEARCH = 7;
      SQLSERVER = 8;
      GREENPLUM = 9;
    }

    message UsedResourcesInCloud {
        string cloud_id = 1;
        Type cluster_type = 2;
        string role = 3;
        string platform_id = 4;
        int64 cores = 5;
        int64 memory = 6;
    }

    repeated UsedResourcesInCloud resources = 1;
}

message GetFolderStatsRequest {
  string folder_id = 1;
}

message FolderStats {
  message ClusterStats {
    ClusterType cluster_type = 1;
    int64 clusters_count = 2;
  }

  // List of stats per cluster type. If cluster type is missing it means there are no clusters of that type.
  repeated ClusterStats cluster_stats = 1;
}
