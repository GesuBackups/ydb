syntax = "proto3";

package yandex.cloud.priv.marketplace.v2.partners;

import "google/api/annotations.proto";

import "yandex/cloud/api/operation.proto";
import "yandex/cloud/priv/marketplace/v2/product.proto";
import "yandex/cloud/priv/operation/operation.proto";
import "yandex/cloud/priv/validation.proto";


option go_package = "a.yandex-team.ru/cloud/bitbucket/private-api/yandex/cloud/priv/marketplace/v2/partners;marketplace_partners";
option java_outer_classname = "PMPPS";

service ProductService {
    rpc Get (GetProductRequest) returns (Product){
        option (google.api.http) = { get: "/marketplace/v2/partners/publishers/{publisher_id}/products/{product_id}"};
    }

    rpc List (ListProductsRequest) returns (ProductsListResponse){
        option (google.api.http) = { get: "/marketplace/v2/partners/publishers/{publisher_id}/products"};
    }

    rpc Create (ProductCreateRequest) returns (operation.Operation) {
        option (google.api.http) = { post: "/marketplace/v2/partners/publishers/{publisher_id}/products" body: "*"};

        option (yandex.cloud.api.operation) = {
        metadata: "CreateProductMetadata"
        response: "Product"
    };
    }

}

message GetProductRequest {
    string publisher_id = 1 [(required) = true, (length) = "<=50"];
    string product_id = 2 [(required) = true, (length) = "<=50"];
}

message ListProductsRequest {
    string publisher_id = 1 [(required) = true, (length) = "<=50"];
}

message ProductsListResponse {
    string next_page_token = 1;
    repeated Product products = 2;
}

message CreateProductMetadata {
    string publisher_id = 1;
    string product_id = 2;
    string version_id = 3;
    string proposal_id = 4;
}

message ProductCreateRequest {
    string publisher_id = 1 [(required) = true, (length) = "<=50"];
    string name = 2 [(required) = true, (pattern) = "|[a-z][-a-z0-9]{1,61}[a-z0-9]"];
    Product.Type type = 3;
}
