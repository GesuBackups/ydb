syntax = "proto3";

package yandex.cloud.priv.marketplace.v2;

import "google/protobuf/timestamp.proto";
import "yandex/cloud/priv/validation.proto";

option go_package = "a.yandex-team.ru/cloud/bitbucket/private-api/yandex/cloud/priv/marketplace/v2;marketplace";
option java_outer_classname = "PMSKU";

message Sku {
    string id = 1;
    string check_formula = 2;
}

message SkuDraftTranslation {
    string name = 1;
}

message SkuDraft {
    string product_id = 1;
    string id = 2;
    State state = 3;
    Unit unit = 4;
    google.protobuf.Timestamp created_at = 5;
    google.protobuf.Timestamp updated_at = 6;
    repeated PricingVersionDraft pricing_versions = 7;
    map<string, SkuDraftTranslation> translations = 8;

    enum State {
        STATE_UNSPECIFIED = 0;
        ACTIVE = 1;
        DELETED = 2;
    }

    enum Unit {
        UNIT_UNSPECIFIED = 0;
        CORE_PER_SECOND = 1;
        INSTANCE_PER_SECOND = 2;
    }

    message PricingVersionDraft {
        AggregationInfo aggregation_info = 1;
        PricingExpression pricing_expression = 2;
    }

    message PricingExpression {
        // Decimal
        string quantum = 1 [(pattern) = "[0-9]+(\\.[0-9]+)?"];
        Rate rates = 2;
    }

    message Rate {
        int64 start_pricing_quantity = 1;
        // Decimal
        string unit_price = 2 [(pattern) = "[0-9]+(\\.[0-9]+)?"];
    }

    message AggregationInfo {
        enum AggregationLevel {
            AGGREGATION_LEVEL_UNSPECIFIED = 0;
            BILLING_ACCOUNT_ID = 1;
        }
        enum AggregationInterval {
            AGGREGATION_INTERVAL_UNSPECIFIED = 0;
            MONTH = 1;
        }
        AggregationLevel level = 1;
        AggregationInterval interval = 2;
    }
}
