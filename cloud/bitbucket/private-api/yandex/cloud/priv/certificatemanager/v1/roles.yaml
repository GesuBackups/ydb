role_groups:
  certificate-manager:
    name: Certificate manager roles

roles:

  certificate-manager.viewer:
    groups: [certificate-manager]
    name: Certificate Manager Viewer
    visibility: public
    description: Чтение в Certificate Manager
    permissions:
      - certificate-manager.certificates.{get,list}
      - certificate-manager.certificates.listAccessBindings
      - certificate-manager.certificates.listReferences
      - certificate-manager.domains.{get,list}
      - certificate-manager.domains.listAccessBindings
      - certificate-manager.domains.listReferences
      - certificate-manager.quotas.get

  certificate-manager.editor:
    groups: [certificate-manager]
    name: Certificate Manager Editor
    visibility: public
    description: Чтение и запись в Certificate Manager
    includedRoles:
      - certificate-manager.viewer
    permissions:
      - certificate-manager.certificates.{create,requestNew,delete,update,renew}
      - certificate-manager.domains.{create,delete,update,setPrimaryCertificate}

  certificate-manager.admin:
    groups: [certificate-manager]
    name: Администратор Certificate Manager
    visibility: public
    description: Чтение, запись и управление доступом в Certificate Manager
    includedRoles:
      - certificate-manager.editor
    permissions:
      - certificate-manager.certificates.{list,update}AccessBindings
      - certificate-manager.certificates.readContent
      - certificate-manager.domains.{list,update}AccessBindings
      - iam.folders.get
      - resource-manager.folders.get

  certificate-manager.certificates.contentViewer:
    groups: [certificate-manager]
    name: (Внутренняя) Просмотр содержимого сертификата
    visibility: internal
    description: доступ к публичной и приватной части сертификата для внутренних сервисов Облака
    permissions:
    - certificate-manager.certificates.readContent
    - certificate-manager.certificates.getContentMetadata
    - certificate-manager.certificates.{list,update}References

  certificate-manager.certificates.downloader:
    groups: [certificate-manager]
    name: Просмотр содержимого сертификата
    visibility: public
    description: доступ к публичной и приватной части сертификата
    permissions:
      - certificate-manager.certificates.readContent
      - certificate-manager.certificates.{get,list}

  certificate-manager.domains.viewer:
    groups: [certificate-manager]
    name: (Внутренняя) Просмотр метаданных домена для интеграции в dpl
    visibility: internal
    description: доступ к метаданным домена
    permissions:
      - certificate-manager.domains.getMetadata
      - certificate-manager.domains.{list,update}References

  certificate-manager.support:
    groups: [certificate-manager, support]
    name: Support Certificate Manager
    description: Role for support engineers
    visibility: internal
    includedRoles:
      - certificate-manager.viewer
    permissions:
      - certificate-manager.quotas.updateLimit

  certificate-manager.supportAdmin:
    groups: [certificate-manager, support]
    name: Support Certificate Manager
    description: Role for support engineers
    visibility: internal
    includedRoles:
      - certificate-manager.support
    permissions:
      - certificate-manager.certificates.getContentMetadata
      - certificate-manager.domains.getMetadata
      - certificate-manager.certificates.listReferences
      - certificate-manager.domains.listReferences

  certificate-manager.onCall:
    groups: [certificate-manager, staff]
    name: OnCall Certificate Manager
    description: Role for on-call engineers
    visibility: internal
    includedRoles:
      - onCall
      - certificate-manager.viewer
    permissions:
      - certificate-manager.certificates.listAccessBindings
      - certificate-manager.certificates.listReferences
      - certificate-manager.certificates.getContentMetadata
      - certificate-manager.domains.listAccessBindings
      - certificate-manager.domains.listReferences
      - certificate-manager.domains.getMetadata

  certificate-manager.onCallAdmin:
    groups: [certificate-manager, support]
    name: On-call Certificate Manager Admin
    description: Role for on-call admins
    visibility: internal
    includedRoles:
      - certificate-manager.onCall
    permissions:
      - certificate-manager.certificates.delete
      - certificate-manager.certificates.updateAccessBindings
      - certificate-manager.certificates.updateReferences
      - certificate-manager.domains.delete
      - certificate-manager.domains.updateAccessBindings
      - certificate-manager.domains.updateReferences

  internal.certificate-manager.cpl:
    groups: [certificate-manager]
    name: (Внутренняя) Доступы для агентов certificate-manager CPL
    description: Доступ к биндингам чужих облаков. Используется для определения владельца облака при оповещении
    visibility: internal
    permissions:
      - resource-manager.clouds.get
      - resource-manager.clouds.listAccessBindings
      - resource-manager.folders.get

  internal.certificate-manager.providers.user:
    groups: [certificate-manager]
    name: Allows creating INTERNAL_* certificates.
    description: Role for Yandex Cloud services admins.
    visibility: internal
    permissions:
      - certificate-manager.providers.use
