syntax = "proto3";

package yandex.cloud.priv.organizationmanager.v1.transitional;

import "yandex/cloud/api/operation.proto";
import "yandex/cloud/priv/operation/operation.proto";
import "yandex/cloud/priv/validation.proto";

option go_package = "a.yandex-team.ru/cloud/bitbucket/private-api/yandex/cloud/priv/organizationmanager/v1/transitional;organizationmanager";
option java_outer_classname = "PTORGS";

service OrganizationService {
  rpc Migrate (MigrateOrganizationRequest) returns (operation.Operation) {
    option (yandex.cloud.api.operation) = {
      metadata: "MigrateOrganizationMetadata"
      response: "CollaborationOrganization"
    };
  }

  rpc EnableServices (EnableServicesRequest) returns (operation.Operation) {
    option (yandex.cloud.api.operation) = {
      metadata: "EnableServicesMetadata"
      response: "CollaborationOrganization"
    };
  }

  // List user organizations.
  rpc List (ListOrganizationsRequest) returns (ListOrganizationsResponse);
}

message MigrateOrganizationRequest {
  int64 directory_organization_id = 1 [(value) = ">0"];
}

message MigrateOrganizationMetadata {
  int64 directory_organization_id = 1 [(value) = ">0"];
}

message EnableServicesRequest {
  string organization_id = 1 [(required) = true, (length) = "<=50"];
}

message EnableServicesMetadata {
  string organization_id = 1;
}

message ListOrganizationsRequest {
  OrganizationType type = 5;
}

message ListOrganizationsResponse {
  repeated CollaborationOrganization organizations = 1;
}

// lightweight version of private-api/yandex/cloud/priv/organizationmanager/v1/organization.proto:10
message CollaborationOrganization {
  string id = 1;
  string title = 6;
  string directory_organization_id = 10;
}

enum OrganizationType {
  ORGANIZATION_TYPE_UNSPECIFIED = 0;
  CLOUD = 1;
  CONNECT = 2;
}
