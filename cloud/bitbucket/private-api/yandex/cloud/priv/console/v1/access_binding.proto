syntax = "proto3";

package yandex.cloud.priv.console.v1;

import "yandex/cloud/priv/oauth/claims.proto";
import "yandex/cloud/priv/servicecontrol/v1/resource.proto";
import "yandex/cloud/priv/validation.proto";

option go_package = "a.yandex-team.ru/cloud/bitbucket/private-api/yandex/cloud/priv/console/v1;console";
option java_outer_classname = "PCAB";

// Common messages to be reused by console-specific service facade methods for listing access bindings.
// See yandex/cloud/priv/iam/v1/console/service_account_service.proto for usage example.

message ListAccessBindingsRequest {
  // Service-specific resource id (e.g. folder_id, compute_instance_id, etc.)
  string resource_id = 1 [(required) = true, (length) = "<=50"];
  int64 page_size = 2 [(value) = "<=1000"];
  string page_token = 3 [(length) = "<=100"];
  // Access bindings listing filter. Filter specs are TBD.
  string filter = 4 [(length) = "<=1000"];
  bool get_inherited_bindings = 5;
}

message ListAccessBindingsResponse {
  repeated SubjectWithBindings subjects_with_bindings = 1;
  string next_page_token = 2;
}

message SubjectWithBindings {
  yandex.cloud.priv.oauth.SubjectClaims subject_claims = 1;
  // A few first access bindings.
  repeated AccessBinding access_bindings = 2;
  // Number of access bindings that are present in addition to access_bindings above.
  int64 more_access_bindings = 3;
}

message AccessBinding {
  string role_id = 1;
  // If present, specifies a resource this access binding is inherited from.
  servicecontrol.v1.Resource inherited_from = 3;
}
