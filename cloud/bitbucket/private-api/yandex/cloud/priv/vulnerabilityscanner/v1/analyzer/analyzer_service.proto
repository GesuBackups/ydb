syntax = "proto3";

package yandex.cloud.priv.vulnerabilityscanner.v1.analyzer;

import "google/protobuf/timestamp.proto";

import "yandex/cloud/api/operation.proto";
import "yandex/cloud/priv/operation/operation.proto";
import "yandex/cloud/priv/validation.proto";
import "yandex/cloud/priv/vulnerabilityscanner/v1/scanner.proto";

option go_package = "a.yandex-team.ru/cloud/bitbucket/private-api/yandex/cloud/priv/vulnerabilityscanner/v1/analyzer;vulnerabilityscanner_analyzer";
option java_outer_classname = "PVSAS";

service AnalyzerService {

    rpc Analyze (AnalyzeRequest) returns (operation.Operation) {
        option (yandex.cloud.api.operation) = {
        metadata: "AnalyzeMetadata"
        response: "AnalyzeResult"
      };
    };

}

message AnalyzeRequest {
    ImageId image_id = 1 [(required) = true];
}

message AnalyzeMetadata {
    ImageId image_id = 1;
    google.protobuf.Timestamp started_at = 2;
}

message AnalyzeResult {
    enum Status {
        STATUS_UNSPECIFIED = 0;
        RUNNING = 1;
        READY = 2;
        ERROR = 3;
    }

    ImageId image_id = 1;
    Status status = 2;
    google.protobuf.Timestamp started_at = 3;
    google.protobuf.Timestamp finished_at = 4;
}
